# Puppeteer - Sample

## üìñ Sobre o Projeto
Este projeto √© um reposit√≥rio base para execu√ß√£o de scraping de p√°ginas web com o Puppeteer, utilizando Docker para facilitar a hospedagem e isolamento do ambiente.

## üöÄ Tecnologias e Ferramentas
O projeto foi criado em JavaScript (mas pode ser facilmente convertido para TypeScript) com o Puppeteer e utiliza um Dockerfile para simplificar o uso.

#### Bibliotecas e Tecnologias Utilizadas:
| Tecnologia           | Vers√£o    |
|----------------------|-----------|
| **Runtime**           |           |
| Node                  | v18.x     |
| **Desenvolvimento**   |           |
| Docker Engine         | vXX.X.X   |
| Bundler               | v2.6.0    |

### Organiza√ß√£o do Projeto

```
/
‚îú‚îÄüìÅ .devcontainer     -> Configura√ß√µes do ambiente de desenvolvimento (Devcontainer)
‚îú‚îÄüìÅ docs              -> Artefatos de documenta√ß√£o
‚îú‚îÄ‚îÄüìÅsrc
‚îÇ   ‚îú‚îÄüáØindex.js            -> Arquivo principal para iniciar o scraping
‚îÇ       ...
‚îÇ   ‚îú‚îÄüìÅscraping
‚îÇ      ‚îú‚îÄüáØscraper.js       ->  Fun√ß√µes de scraping espec√≠ficas (e.g., pesquisa no Google)
‚îÇ       ...
‚îÇ   ‚îú‚îÄüìÅutils             
‚îÇ      ‚îú‚îÄüáØfileManager.js   -> Fun√ß√µes para salvar capturas de tela, dados, etc.
‚îÇ      ‚îú‚îÄüáØlogger.js        -> Logs e tratamento de erros
‚îÇ       ...
‚îú‚îÄ‚îÄüìÅ Config
‚îÇ   ‚îú‚îÄüáØbrowser.js          -> configura√ß√µes do navegador
‚îÇ   ‚îú‚îÄüáØconfig.js           -> configura√ß√µes do Puppeteer
‚îÇ       ...
‚îú‚îÄüìÅscreenshots             -> Pasta onde as capturas de tela ser√£o salvas
‚îú‚îÄüìÅdata                    -> Pasta para salvar dados coletados (N√£o implementado)
‚îú‚îÄ‚îÄ package.json            -> Configura√ß√µes e depend√™ncias do projeto
‚îú‚îÄüìÑ .gitignore             -> Arquivos e pastas ignorados pelo Git
‚îú‚îÄüìÑ Makefile               -> Automa√ß√£o de tarefas
‚îî‚îÄüìÑ README.md              -> Documenta√ß√£o do projeto (Este arquivo)
```

## üõ†Ô∏è Configura√ß√£o do Ambiente de Desenvolvimento

Este reposit√≥rio est√° configurado para rodar em um **Devcontainer** no VSCode. Siga os passos abaixo para instanciar o ambiente.

### Extens√µes Recomendadas

- **Nome**: Remote Development
- **Id**: `ms-vscode-remote.vscode-remote-extensionpack`
- **Descri√ß√£o**: Pacote de extens√µes que permite abrir pastas em containers, m√°quinas remotas ou WSL com todas as funcionalidades do VSCode.
- **Vers√£o**: 0.25.0
- [VSCode Marketplace Link](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack)

### Docker Engine

√â necess√°rio ter o Docker Engine instalado. Veja o guia de instala√ß√£o para seu sistema operacional [aqui](https://docs.docker.com/engine/install/).

### Procedimento para Instanciar o Projeto no VSCode

1. Instale o pacote de extens√µes recomendadas.
2. Clone ou fa√ßa fork deste reposit√≥rio.
3. Abra o diret√≥rio do projeto no VSCode.
4. Execute o comando _Dev Containers: Reopen in Container_ na paleta de comandos do VSCode (_F1, Ctrl+Shift+P_).

Ap√≥s a configura√ß√£o do Devcontainer, o VSCode abrir√° o projeto dentro de um ambiente isolado, conforme definido no diret√≥rio **/.devcontainer**.

## üöÄ Iniciando a Aplica√ß√£o

1. Para iniciar o scraping (instalar as depend√™ncias e configurar o ambiente):
    ```sh
    make scraping
    ```

### Gerenciamento de Depend√™ncias

1. Instale uma nova biblioteca:
    ```sh
    npm install <nome_da_lib>
    ```

## üìñ Caso Prefira sem o Devcontainer

Se voc√™ preferir configurar e executar o projeto sem usar o devcontainer, siga as instru√ß√µes abaixo:

### Pr√©-requisitos

- Node.js (vers√£o 18 ou superior)
- npm (vers√£o 6 ou superior)
- Docker (opcional, se desejar usar o Docker para executar o Puppeteer)


### Executando o scraping

1. **Execute o scraping:**

    ```sh
    make scraping
    ```

2. **(Opcional) Execute o scraping usando Docker:**

    Se preferir usar Docker para isolar o ambiente de execu√ß√£o, voc√™ pode construir e executar o cont√™iner Docker:

    ```sh
    docker build -t puppeteer-scraping .
    docker run --rm -it puppeteer-scraping
    ```

### Personaliza√ß√£o

O projeto est√° estruturado para facilitar a organiza√ß√£o e expans√£o do c√≥digo de scraping com o Puppeteer. Abaixo, indicamos os principais pontos onde voc√™ pode fazer ajustes e adicionar funcionalidades.

#### 1. Configura√ß√µes Gerais

- As configura√ß√µes principais do Puppeteer e as URLs de destino est√£o centralizadas no arquivo `src/config/config.js`. Voc√™ pode ajustar as op√ß√µes do navegador, URLs e seletores aqui. Por exemplo:
  - **Modo de exibi√ß√£o**: Para ver o navegador em a√ß√£o, altere a op√ß√£o `headless` para `false` no objeto `PUPPETEER_OPTIONS`.
  - **URLs**: Modifique ou adicione URLs no objeto `URLS` para configurar novos destinos de scraping.

#### 2. Scripts de Scraping

- A l√≥gica de scraping espec√≠fica √© definida no arquivo `src/scraping/scraper.js`. Cada fun√ß√£o dentro deste arquivo realiza uma tarefa espec√≠fica de scraping. Por exemplo:
  - **Fun√ß√£o `performGoogleSearch`**: Realiza uma pesquisa no Google. Voc√™ pode duplicar e modificar essa fun√ß√£o para incluir novos fluxos de scraping para outras p√°ginas ou funcionalidades dentro do Google.

#### 3. Gerenciamento de Arquivos e Logs

- No diret√≥rio `src/utils`, voc√™ encontrar√° utilit√°rios para salvar capturas de tela e gerenciar logs.
  - **Capturas de Tela**: A fun√ß√£o `saveScreenshot` no arquivo `fileManager.js` salva capturas de tela na pasta `screenshots`. Para modificar o nome ou o local dos arquivos, ajuste a fun√ß√£o ou os valores no arquivo `config.js`.
  - **Logs e Erros**: O `logger.js` oferece fun√ß√µes para centralizar logs de informa√ß√µes e erros, tornando o processo de depura√ß√£o mais claro. Esses logs s√£o acionados diretamente no `index.js`.

#### 4. Expans√£o com Novas Tarefas

- Para adicionar novos fluxos de scraping:
  1. Crie uma nova fun√ß√£o no arquivo `scraper.js` ou crie um novo m√≥dulo (arquivo) para uma tarefa espec√≠fica.
  2. Importe e chame as novas fun√ß√µes no `index.js` para orquestrar diferentes fluxos.